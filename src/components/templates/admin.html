<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet"/>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
</head>
<body>
    <input type="hidden" id="csrf_token" name="csrf_token" value="{{ csrf_token() }}">
    
    <div class="sidebar">
        <div class="side_bar_top">
            <div class="sidebar-header">
                <h2>Admin</h2>
                <button class="pin-button" aria-label="Toggle sidebar"><i class="ri-arrow-left-s-line"></i></button>
            </div>
            <ul class="sidebar-menu">
                <li data-section="home" class="active"><i class="ri-home-line"></i><span>Home</span></li>
                <li data-section="users"><i class="ri-user-line"></i><span>Users</span></li>
                <li data-section="queries"><i class="ri-questionnaire-line"></i><span>Queries</span></li>
                <li data-section="organizations"><i class="ri-team-line"></i><span>Organizations</span></li>
                <li data-section="partners"><i class="ri-group-3-line"></i><span>Partners</span></li>
                <li data-section="qrcodes"><i class="ri-qr-code-line"></i><span>QR Codes</span></li>
                <li data-section="products"><i class="ri-shopping-bag-line"></i><span>Products</span></li>
            </ul>
        </div>
        <div class="sidebar-footer">
            <button class="admin_logout" onclick="admin_logout()"><i class="ri-logout-circle-line"></i><span>Logout</span></button>
        </div>
    </div>


    <div class="content">
        <div id="home" class="section active">
            <h1>Admin Panel</h1>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Total Users</h3>
                    <p id="total-users">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Active Users</h3>
                    <p id="active-users">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Google Accounts</h3>
                    <p id="google-accounts">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Scheduled for Deletion Users</h3>
                    <p id="scheduled-for-deletion-users">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Permanently Deleted Users</h3>
                    <p id="permanently-deleted-users">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Re-Registered Users</h3>
                    <p id="re-registered-users">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Restored Accounts</h3>
                    <p id="restored-accounts">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Banned Users</h3>
                    <p id="banned-users">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>New Users (Last Month)</h3>
                    <p id="new-users-month">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Deleted Users (Last Month)</h3>
                    <p id="deleted-users-month">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Growth Rate (Per Month)</h3>
                    <p id="user-growth-rate">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Average User Lifetime</h3>
                    <p id="avg-user-lifetime">Loading...</p>
                </div>
            </div>
    
            <div class="dashboard-grid-2">
                <div class="chart-container" id="role-distribution-chart-container">
                    <h3>Role Distribution</h3>
                    <div class="inner-chart-container">
                        <canvas id="role-distribution-chart"></canvas>
                    </div>
                </div>
                <div class="chart-container" id="verification-status-chart-container">
                    <h3>Verification Status</h3>
                    <div class="inner-chart-container">
                        <canvas id="verification-status-chart"></canvas>
                    </div>
                </div>
                <div class="chart-container" id="top-countries-chart-container">
                    <h3>Top Countries</h3>
                    <div class="inner-chart-container">
                        <canvas id="top-countries-chart"></canvas>
                    </div>
                </div>
            </div>
    
            <div class="chart-container" id="user-progress-chart-container">
                <h3>User Progress</h3>
                <canvas id="user-progress-chart"></canvas>
            </div>
            <div class="chart-container" id="login-activity-heatmap-container">
                <h3>Login Activity Heatmap (Last 7 Days)</h3>
                <div id="login-activity-heatmap"></div>
            </div>
        </div>
    
        <div id="users" class="section">
            <h1>User Management</h1>
            <div class="mb-3">
                <button id="exportCSV" class="btn btn-primary">Export CSV</button>
                <button id="exportExcel" class="btn btn-success">Export Excel</button>
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addUserModal">Add User</button>
            </div>
            <div class="dataTables_wrapper">
                <div class="dataTables_filter">
                    <span>Filters: </span>
                    <div class="filter-dropdown">
                        <select id="userFilter" class="form-select form-select-sm">
                            <option value="all">All Users</option>
                            <option value="active">Active</option>
                            <option value="banned">Banned</option>
                            <option value="deleted">Scheduled for Deletion</option>
                            <option value="permanently_deleted">Permanently Deleted</option>
                        </select>
                    </div>
                </div>
            </div>
            <table id="userTable" class="table table-striped table-bordered" style="width: 100%;">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Role</th>
                        <th>Contact Number</th>
                        <th>Address</th>
                        <th>Available Tokens</th>
                        <th>Total Tokens</th>
                        <th>Subscription ID</th>
                        <th>Customer ID</th>
                        <th>Registration Date</th>
                        <th>Last Login</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- User data will be loaded here -->
                </tbody>
            </table>
        </div>
    
        <div id="queries" class="section">
            <h1>Queries</h1>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Total Queries</h3>
                    <p id="total-queries">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Read Queries</h3>
                    <p id="read-queries">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Replied Queries</h3>
                    <p id="replied-queries">Loading...</p>
                </div>
            </div>
            <!-- Table to display queries -->
            <table id="queriesTable" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Query</th>
                        <th>Response</th>
                        <th>Read</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    
        <div id="organizations" class="section">
            <h1>Organizations</h1>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Total Organizations</h3>
                    <p id="total-organizations">Loading...</p>
                </div>
            </div>
            <div class="mb-3" style="text-align: right;">
                <button class="btn btn-primary" id="addOrganization">Add Organization</button>
            </div>
            <!-- Table to display organizations -->
            <table id="organizationsTable" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Title</th>
                        <th>Description</th>
                        <th>Contact Number</th>
                        <th>Partners</th>
                        <th>Image</th>
                        <th>Location Link</th>
                        <th>Latitude</th>
                        <th>Longitude</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    
        <div id="partners" class="section">
            <h1>Partners</h1>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Total Partners</h3>
                    <p id="total-partners">Loading...</p>
                </div>
            </div>
            <div class="mb-3" style="text-align: right;">
                <button class="btn btn-primary" id="addPartner">Add Partner</button>
            </div>
            <table id="partnersTable" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Password</th>
                        <th>Contact Number</th>
                        <th>Address</th>
                        <th>Shipping Address</th>
                        <th>Organization</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
        <div id="qrcodes" class="section">
            <h1>QR Codes</h1>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Total QR Codes</h3>
                    <p id="total-qrcodes">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Active QR Codes</h3>
                    <p id="active-qrcodes">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Inactive QR Codes</h3>
                    <p id="in-active-qrcodes">Loading...</p>
                </div>
                <div class="dashboard-card">
                    <h3>Total Visits</h3>
                    <p id="total-visits">Loading...</p>
                </div>
            </div>
            <div class="mb-3" style="text-align: right;">
                <div class="qr_code_form_control">
                    <select id="downloadForDropdown" class="form-select" style="display: inline-block; width: auto; margin-right: 10px;">
                        <option value="">Download for</option>
                        <option value="all">All QR Codes</option>
                    </select>
                    <button class="btn btn-success" id="downloadSelected" disabled>Download Selected</button>
                    <button class="btn btn-success" id="downloadAll">Download All</button>
                    <button class="btn btn-success" id="downloadUnassigned">Download Unassigned</button>
		</div>
                <div class="qr_code_form_control">
                    <button class="btn btn-primary" id="addQRCode">Add QR Code</button>
                    <button class="btn btn-secondary" id="bulkGenerateQRCodes">Bulk Generate QR Codes</button>
                </div>
                <div class="qr_code_form_control">
                    <select id="assignPartnerDropdown" class="form-select" style="display: none; width: auto;">
                        <option value="">Assign Partner to Selected</option>
                    </select>
                    <button class="btn btn-danger" id="deleteSelectedQRCodes" style="display: none;">Delete Selected</button>
                </div>
            </div>            
            <table id="qrcodesTable" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th><input type="checkbox" id="selectAllQRCodes"></th>
                        <th>ID</th>
                        <th>URL</th>
                        <th>Partner Name</th>
                        <th>Partner Email</th>
                        <th>Deceased Name</th>
                        <th>Active</th>
                        <th>Visit Count</th>
                        <th>Last Visit</th>
                        <th>QR Image</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    
        <div id="products" class="section">
            <h1>Products</h1>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Total Products</h3>
                    <p id="total-products">Loading...</p>
                </div>
            </div>
            <div class="mb-3" style="text-align: right;">
                <button class="btn btn-primary" id="addProduct" data-bs-toggle="modal" data-bs-target="#addProductModal">Add Product</button>
            </div>
            <table id="productsTable" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Description</th>
                        <th>Price</th>
                        <th>Provider Name</th>
                        <th>Provider Email</th>
                        <th>Provider Number</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
    <!-- Add User Modal -->
    <div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addUserModalLabel">Add User</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addUserForm">
                        <div class="mb-3">
                            <label for="name" class="form-label">Name</label>
                            <input type="text" class="form-control" id="name" name="name" required>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                        </div>
                        <div class="mb-3">
                            <label for="contact_number" class="form-label">Contact Number</label>
                            <input type="tel" class="form-control" id="contact_number" name="contact_number" required>
                        </div>
                        <div class="mb-3">
                            <label for="deceased_name" class="form-label">Deceased Name</label>
                            <input type="text" class="form-control" id="deceased_name" name="deceased_name" required>
                        </div>
                        <div class="mb-3">
                            <label for="address" class="form-label">Address</label>
                            <input type="text" class="form-control" id="address" name="address">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary" form="addUserForm">Add User</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit User Modal -->
    <div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editUserModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editUserModalLabel">Edit User</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editUserForm">
                        <input type="hidden" id="editUserId">
                        <div class="mb-3">
                            <label for="pfpDisplay" class="form-label">Profile Picture</label>
                            <p id="pfpDisplay"></p>
                            <button type="button" id="removePfp" class="btn btn-danger">Remove Profile Picture</button>
                        </div>
                        <div class="mb-3">
                            <label for="editName" class="form-label">Name</label>
                            <input type="text" class="form-control" id="editName" required>
                        </div>
                        <div class="mb-3">
                            <label for="editEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="editEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="editContactNumber" class="form-label">Contact Number</label>
                            <input type="text" class="form-control" id="editContactNumber" required>
                        </div>
                        <div class="mb-3">
                            <label for="editAddress" class="form-label">Address</label>
                            <input type="text" class="form-control" id="editAddress" required>
                        </div>
                        <div class="mb-3">
                            <label for="editRole" class="form-label">Role</label>
                            <select class="form-control" id="editRole" required>
                                <option value="1">User</option>
                                <option value="2">Administrator</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="editTokensAvailable" class="form-label">Available Tokens</label>
                            <input type="number" class="form-control" id="editTokensAvailable" required>
                        </div>
                        <div class="mb-3">
                            <label for="editTokensTotal" class="form-label">Total Tokens</label>
                            <input type="number" class="form-control" id="editTokensTotal" required>
                        </div>
                        <div class="mb-3">
                            <label for="editSubscriptionId" class="form-label">Subscription ID</label>
                            <input type="text" class="form-control" id="editSubscriptionId" required>
                        </div>
                        <div class="mb-3">
                            <label for="editCustomerId" class="form-label">Customer ID</label>
                            <input type="text" class="form-control" id="editCustomerId" required>
                        </div>
                        <div class="mb-3">
                            <label for="editSecurityQuestion" class="form-label">Security Question</label>
                            <select class="form-control" id="editSecurityQuestion" required>
                                <option value="What is your mother's maiden name?">What is your mother's maiden name?</option>
                                <option value="What was the name of your first pet?">What was the name of your first pet?</option>
                                <option value="What was the name of your elementary school?">What was the name of your elementary school?</option>
                                <option value="In what city were you born?">In what city were you born?</option>
                                <option value="What is your favorite book?">What is your favorite book?</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="editSecurityAnswer" class="form-label">Security Answer</label>
                            <input type="text" class="form-control" id="editSecurityAnswer" required>
                        </div>
                        <div class="mb-3">
                            <label for="editRefreshToken" class="form-label">Refresh Token</label>
                            <p id="refresh_token_status">The Refresh Token exists.</p>
                            <button type="button" id="deleteRefreshToken" class="btn btn-danger">Delete Refresh Token</button>
                        </div>
                        <div class="mb-3">
                            <label for="editDeleted" class="form-label">Deleted</label>
                            <input type="text" class="form-control" id="editDeleted" readonly>
                        </div>
                        <div class="mb-3">
                            <label for="editDeletedAt" class="form-label">Deleted At</label>
                            <input type="text" class="form-control" id="editDeletedAt" readonly>
                        </div>
                        <div class="mb-3">
                            <label for="editReRegistered" class="form-label">Re-Registered</label>
                            <input type="text" class="form-control" id="editReRegistered" readonly>
                        </div>
                        <div class="mb-3">
                            <label for="editIsBanned" class="form-label">Is Banned</label>
                            <input type="text" class="form-control" id="editIsBanned" readonly>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="saveUserChanges">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- User Ban Modal -->
<div class="modal fade" id="banUserModal" tabindex="-1" aria-labelledby="banUserModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="banUserModalLabel">Ban User</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="banUserForm">
                    <input type="hidden" id="banUserId">
                    <div class="mb-3">
                        <label for="banReason" class="form-label">Reason for Ban</label>
                        <div id="banReason"></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-danger" id="confirmBan">Ban User</button>
            </div>
        </div>
    </div>
</div>


    <!-- Send Notification Modal -->
    <div class="modal fade" id="sendNotificationModal" tabindex="-1" aria-labelledby="sendNotificationModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="sendNotificationModalLabel">Send Notification</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="sendNotificationForm">
                        <input type="hidden" id="notificationUserId">
                        <div class="mb-3">
                            <label for="notificationSubject" class="form-label">Subject</label>
                            <input type="text" class="form-control" id="notificationSubject" required>
                        </div>
                        <div class="mb-3">
                            <label for="notificationMessage" class="form-label">Message</label>
                            <div id="notificationMessage"></div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="sendNotification">Send</button>
                </div>
                <p id="notify_error"></p>
            </div>
        </div>
    </div>
    

    <!-- Reply Modal -->
    <div class="modal fade" id="replyModal" tabindex="-1" aria-labelledby="replyModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="replyModalLabel">Reply to Query</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="replyForm">
                        <input type="hidden" id="replyQueryId">
                        <div class="mb-3">
                            <label for="subject" class="form-label">Subject</label>
                            <input type="text" class="form-control" id="replySubject" required>
                        </div>
                        <div class="mb-3">
                            <label for="message" class="form-label">Message</label>
                            <div id="quillEditor"></div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="sendReply">Send Reply</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Add Organization Modal -->
    <div class="modal fade" id="addOrganizationModal" tabindex="-1" aria-labelledby="addOrganizationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addOrganizationModalLabel">Add New Organization</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addOrganizationForm">
                        <div class="mb-3">
                            <label for="orgAddName" class="form-label">Name</label>
                            <input type="text" class="form-control" id="orgAddName" name="name" required>
                        </div>
                        <div class="mb-3">
                            <label for="orgAddTitle" class="form-label">Title</label>
                            <input type="text" class="form-control" id="orgAddTitle" name="title" required>
                        </div>
                        <div class="mb-3">
                            <label for="orgAddDescription" class="form-label">Description</label>
                            <textarea class="form-control" id="orgAddDescription" name="description" rows="3" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="orgAddContactNumber" class="form-label">Contact Number</label>
                            <input type="tel" class="form-control" id="orgAddContactNumber" name="contact_number" required>
                        </div>
                        <div class="mb-3">
                            <label for="orgAddLocationLink" class="form-label">Location Link</label>
                            <input type="url" class="form-control" id="orgAddLocationLink" name="location_link" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="orgAddLatitude" class="form-label">Latitude</label>
                                <input type="number" step="any" class="form-control" id="orgAddLatitude" name="lat" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="orgAddLongitude" class="form-label">Longitude</label>
                                <input type="number" step="any" class="form-control" id="orgAddLongitude" name="long" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="orgAddImage" class="form-label">Image</label>
                            <input type="file" class="form-control" id="orgAddImage" name="image" accept="image/*">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" form="addOrganizationForm" class="btn btn-primary">Add Organization</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Edit Organization Modal -->
    <div class="modal fade" id="editOrganizationModal" tabindex="-1" aria-labelledby="editOrganizationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editOrganizationModalLabel">Edit Organization</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editOrganizationForm">
                        <input type="hidden" id="orgEditOrganizationId" name="id">
                        <div class="mb-3">
                            <label for="orgEditName" class="form-label">Name</label>
                            <input type="text" class="form-control" id="orgEditName" name="name" required>
                        </div>
                        <div class="mb-3">
                            <label for="orgEditTitle" class="form-label">Title</label>
                            <input type="text" class="form-control" id="orgEditTitle" name="title" required>
                        </div>
                        <div class="mb-3">
                            <label for="orgEditDescription" class="form-label">Description</label>
                            <textarea class="form-control" id="orgEditDescription" name="description" rows="3" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="orgEditContactNumber" class="form-label">Contact Number</label>
                            <input type="tel" class="form-control" id="orgEditContactNumber" name="contact_number" required>
                        </div>
                        <div class="mb-3">
                            <label for="orgEditLocationLink" class="form-label">Location Link</label>
                            <input type="url" class="form-control" id="orgEditLocationLink" name="location_link" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="orgEditLatitude" class="form-label">Latitude</label>
                                <input type="number" step="any" class="form-control" id="orgEditLatitude" name="lat" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="orgEditLongitude" class="form-label">Longitude</label>
                                <input type="number" step="any" class="form-control" id="orgEditLongitude" name="long" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="orgEditImage" class="form-label">Image</label>
                            <input type="file" class="form-control" id="orgEditImage" name="image" accept="image/*">
                        </div>
                        <div id="orgCurrentImageContainer" class="mb-3">
                            <label class="form-label">Current Image</label>
                            <img id="orgCurrentImage" src="" alt="Current image of the organization" style="max-width: 200px; max-height: 200px;">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" form="editOrganizationForm" class="btn btn-primary">Save Changes</button>
                </div>
            </div>
        </div>
    </div>
    

    <!-- Add Partner Modal -->
    <div class="modal fade" id="addPartnerModal" tabindex="-1" aria-labelledby="addPartnerModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addPartnerModalLabel">Add New Partner</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addPartnerForm">
                        <div class="mb-3">
                            <label for="partnerAddName" class="form-label">Name</label>
                            <input type="text" class="form-control" id="partnerAddName" name="name" required>
                        </div>
                        <div class="mb-3">
                            <label for="partnerAddEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="partnerAddEmail" name="email" required>
                        </div>
                        <div class="mb-3">
                            <label for="partnerAddPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="partnerAddPassword" name="password">
                        </div>
                        <div class="mb-3">
                            <label for="partnerAddContactNumber" class="form-label">Contact Number</label>
                            <input type="tel" class="form-control" id="partnerAddContactNumber" name="contact_number" required>
                        </div>
                        <div class="mb-3">
                            <label for="partnerAddAddress" class="form-label">Address</label>
                            <input type="text" class="form-control" id="partnerAddAddress" name="address" required>
                        </div>
                        <div class="mb-3">
                            <label for="partnerAddShippingAddress" class="form-label">Shipping Address</label>
                            <input type="text" class="form-control" id="partnerAddShippingAddress" name="shipping_address" required>
                        </div>
                        <div class="mb-3">
                            <label for="partnerAddOrganization" class="form-label">Organization</label>
                            <select class="form-control" id="partnerAddOrganization" name="organization_id">
                                <option value="">Select an organization</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" form="addPartnerForm" class="btn btn-primary">Add Partner</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal to Edit Partner -->
<div class="modal fade" id="editPartnerModal" tabindex="-1" aria-labelledby="editPartnerModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editPartnerModalLabel">Edit Partner</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editPartnerForm">
                    <input type="hidden" id="partnerEditPartnerId" name="id">
                    <div class="mb-3">
                        <label for="partnerEditName" class="form-label">Name</label>
                        <input type="text" class="form-control" id="partnerEditName" name="name" required>
                    </div>
                    <div class="mb-3">
                        <label for="partnerEditEmail" class="form-label">Email</label>
                        <input type="email" class="form-control" id="partnerEditEmail" name="email" required>
                    </div>
                    <div class="mb-3">
                        <label for="partnerEditPassword" class="form-label">Password (leave blank to keep the current)</label>
                        <input type="password" class="form-control" id="partnerEditPassword" name="password">
                    </div>
                    <div class="mb-3">
                        <label for="partnerEditContactNumber" class="form-label">Contact Number</label>
                        <input type="tel" class="form-control" id="partnerEditContactNumber" name="contact_number" required>
                    </div>
                    <div class="mb-3">
                        <label for="partnerEditAddress" class="form-label">Address</label>
                        <input type="text" class="form-control" id="partnerEditAddress" name="address" required>
                    </div>
                    <div class="mb-3">
                        <label for="partnerEditShippingAddress" class="form-label">Shipping Address</label>
                        <input type="text" class="form-control" id="partnerEditShippingAddress" name="shipping_address" required>
                    </div>
                    <div class="mb-3">
                        <label for="partnerEditOrganization" class="form-label">Organization</label>
                        <select class="form-control" id="partnerEditOrganization" name="organization_id">
                            <option value="">Select an organization</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" form="editPartnerForm" class="btn btn-primary">Save Changes</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal to Add QR Code -->
<div class="modal fade" id="addQRCodeModal" tabindex="-1" aria-labelledby="addQRCodeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addQRCodeModalLabel">Add New QR Code</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addQRCodeForm">
                    <div class="mb-3">
                        <label for="qrcodeAddURL" class="form-label">URL (optional)</label>
                        <input type="url" class="form-control" id="qrcodeAddURL" name="url">
                    </div>
                    <div class="mb-3">
                        <label for="qrcodeAddPartner" class="form-label">Partner</label>
                        <select class="form-control" id="qrcodeAddPartner" name="partner_id">
                            <option value="">Select a partner</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" form="addQRCodeForm" class="btn btn-primary">Add QR Code</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal to Edit QR Code -->
<div class="modal fade" id="editQRCodeModal" tabindex="-1" aria-labelledby="editQRCodeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editQRCodeModalLabel">Edit QR Code</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editQRCodeForm">
                    <input type="hidden" id="qrcodeEditQRCodeId" name="id">
                    <div class="mb-3">
                        <label for="qrcodeEditURL" class="form-label">URL</label>
                        <input type="url" class="form-control" id="qrcodeEditURL" name="url" required>
                    </div>
                    <div class="mb-3">
                        <label for="qrcodeEditPartner" class="form-label">Partner</label>
                        <select class="form-control" id="qrcodeEditPartner" name="partner_id">
                            <option value="">Select a partner</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="qrcodeEditDeceased" class="form-label">Deceased</label>
                        <select class="form-control" id="qrcodeEditDeceased" name="deceased_id">
                            <option value="">Select a deceased</option>
                        </select>
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="qrcodeEditActive" name="is_active">
                        <label class="form-check-label" for="qrcodeEditActive">Active</label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" form="editQRCodeForm" class="btn btn-primary">Save Changes</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Bulk Generation of QR Codes -->
<div class="modal fade" id="bulkGenerateQRCodesModal" tabindex="-1" aria-labelledby="bulkGenerateQRCodesModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="bulkGenerateQRCodesModalLabel">Bulk Generate QR Codes</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="bulkGenerateQRCodesForm">
                    <div class="mb-3">
                        <label for="bulkGenerateCount" class="form-label">Number of QR Codes to Generate</label>
                        <input type="number" class="form-control" id="bulkGenerateCount" name="count" required min="1">
                    </div>
                    <div class="mb-3">
                        <label for="bulkqrcodeAddPartner" class="form-label">Partner</label>
                        <select class="form-control" id="bulkqrcodeAddPartner" name="partner_id">
                            <option value="">Select a partner</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" form="bulkGenerateQRCodesForm" class="btn btn-primary">Generate QR Codes</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal to Add Product -->
<div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addProductModalLabel">Add Product</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addProductForm" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="productName" class="form-label">Name</label>
                        <input type="text" class="form-control" id="productName" name="name" required>
                    </div>
                    <div class="mb-3">
                        <label for="productDescription" class="form-label">Description</label>
                        <textarea class="form-control" id="productDescription" name="description" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="productPrice" class="form-label">Price</label>
                        <input type="number" class="form-control" id="productPrice" name="price" required min="0" step="0.01">
                    </div>
                    <div class="mb-3">
                        <label for="supplierName" class="form-label">Supplier Name</label>
                        <input type="text" class="form-control" id="supplierName" name="supplier_name" required>
                    </div>
                    <div class="mb-3">
                        <label for="supplierEmail" class="form-label">Supplier Email</label>
                        <input type="email" class="form-control" id="supplierEmail" name="supplier_email" required>
                    </div>
                    <div class="mb-3">
                        <label for="supplierNumber" class="form-label">Supplier Number</label>
                        <input type="text" class="form-control" id="supplierNumber" name="supplier_number" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Images</label>
                        <button type="button" class="btn btn-secondary" id="addImageBtn">Add Image</button>
                        <div id="imageContainer"></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" form="addProductForm" class="btn btn-primary">Add Product</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal to Edit Product -->
<div class="modal fade" id="editProductModal" tabindex="-1" aria-labelledby="editProductModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editProductModalLabel">Edit Product</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editProductForm" enctype="multipart/form-data">
                    <input type="hidden" id="editProductId" name="id">
                    <div class="mb-3">
                        <label for="editProductName" class="form-label">Name</label>
                        <input type="text" class="form-control" id="editProductName" name="name" required>
                    </div>
                    <div class="mb-3">
                        <label for="editProductDescription" class="form-label">Description</label>
                        <textarea class="form-control" id="editProductDescription" name="description" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="editProductPrice" class="form-label">Price</label>
                        <input type="number" class="form-control" id="editProductPrice" name="price" required min="0" step="0.01">
                    </div>
                    <div class="mb-3">
                        <label for="editSupplierName" class="form-label">Supplier Name</label>
                        <input type="text" class="form-control" id="editSupplierName" name="supplier_name" required>
                    </div>
                    <div class="mb-3">
                        <label for="editSupplierEmail" class="form-label">Supplier Email</label>
                        <input type="email" class="form-control" id="editSupplierEmail" name="supplier_email" required>
                    </div>
                    <div class="mb-3">
                        <label for="editSupplierNumber" class="form-label">Supplier Number</label>
                        <input type="text" class="form-control" id="editSupplierNumber" name="supplier_number" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Images</label>
                        <button type="button" class="btn btn-secondary" id="editAddImageBtn">Add Image</button>
                        <div id="editImageContainer"></div>
                    </div>
                    <div id="existingImages" class="mb-3">
                        <!-- Existing images will be displayed here -->
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" form="editProductForm" class="btn btn-primary">Save Changes</button>
            </div>
        </div>
    </div>
</div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
</body>
</html>
